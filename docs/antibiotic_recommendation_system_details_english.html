
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antibiotic Recommendation System - Prediction Model Details</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        
        .container {
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #e74c3c;
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        h2 {
            color: #34495e;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.4em;
        }
        
        h4 {
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        ul, ol {
            margin-bottom: 20px;
            padding-left: 30px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        code {
            background-color: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #e74c3c;
        }
        
        pre {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
        }
        
        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        th {
            background-color: #e74c3c;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        tr:hover {
            background-color: #fdf2f2;
        }
        
        .highlight {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .info-box {
            background-color: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .warning-box {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .success-box {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            border-radius: 10px;
        }
        
        .header h1 {
            color: white;
            border-bottom: none;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #ecf0f1;
            margin-bottom: 0;
        }
        
        .toc {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #e74c3c;
        }
        
        .toc h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        .toc li {
            margin-bottom: 5px;
        }
        
        .toc a {
            color: #e74c3c;
            text-decoration: none;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #7f8c8d;
            border-top: 1px solid #ecf0f1;
        }
        
        .feature-box {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .feature-box h4 {
            color: #e74c3c;
            margin-top: 0;
        }
        
        .performance-metrics {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .performance-metrics h3 {
            color: white;
            margin-top: 0;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            h2 {
                font-size: 1.5em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Antibiotic Recommendation System</h1>
            <p>Prediction Model Details</p>
            <p>Generated on August 08, 2025 at 10:45</p>
        </div>
        
        <div class="toc">
            <h3>Table of Contents</h3>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#model-architecture">Model Architecture</a></li>
                <li><a href="#target-definition">Target Definition</a></li>
                <li><a href="#feature-engineering">Feature Engineering</a></li>
                <li><a href="#training-process">Training Process</a></li>
                <li><a href="#performance-metrics">Performance Metrics</a></li>
                <li><a href="#clinical-application">Clinical Application</a></li>
                <li><a href="#clinical-decision-framework">Clinical Decision Framework</a></li>
                <li><a href="#data-sources">Data Sources</a></li>
                <li><a href="#technical-implementation">Technical Implementation</a></li>
                <li><a href="#clinical-validation">Clinical Validation</a></li>
                <li><a href="#future-enhancements">Future Enhancements</a></li>
                <li><a href="#summary">Summary</a></li>
            </ul>
        </div>
        
        <h1>Antibiotic Recommendation System - Prediction Model Details</h1>
<h2>Overview</h2>
<p>The <strong>Antibiotic Recommendation System</strong> is the core prediction model in the Vivli system. It uses a decision tree to recommend antibiotics in optimal order of efficacy, with cefiderocol as the last resort option. This model directly addresses the clinical requirement to provide sequential treatment recommendations.</p>
<h2>Model Architecture</h2>
<h3>Algorithm</h3>
<ul>
<li><strong>Primary Model</strong>: Decision Tree Classifier</li>
<li><strong>Max Depth</strong>: 10</li>
<li><strong>Random State</strong>: 42</li>
<li><strong>Train/Test Split</strong>: 80/20</li>
</ul>
<h3>Model Parameters</h3>
<div class="codehilite"><pre><span></span><code><span class="n">DecisionTreeClassifier</span><span class="p">(</span>
    <span class="n">max_depth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
</code></pre></div>

<h2>Target Definition</h2>
<p>The model predicts the <strong>first-choice antibiotic</strong> for a given infection, then provides a complete sequence of alternatives:</p>
<p><strong>Target</strong>: First antibiotic recommendation (categorical)
<strong>Output</strong>: Complete antibiotic sequence with cefiderocol as last resort</p>
<h2>Feature Engineering</h2>
<h3>1. Primary Features (7 total)</h3>
<ol>
<li><strong>Species encoded</strong> (LabelEncoder)</li>
<li><strong>Country encoded</strong> (LabelEncoder)</li>
<li><strong>Year</strong> (temporal data)</li>
<li><strong>Beta-lactam resistance</strong> (mean resistance score)</li>
<li><strong>Aminoglycoside resistance</strong> (mean resistance score)</li>
<li><strong>Quinolone resistance</strong> (mean resistance score)</li>
<li><strong>Other resistance</strong> (mean resistance score)</li>
</ol>
<h3>2. Antibiotic Analysis (40+ antibiotics)</h3>
<p>The system analyzes 40+ antibiotics including:</p>
<p><strong>Carbapenems</strong>: Meropenem, Imipenem, Doripenem, Ertapenem, Tebipenem
<strong>Beta-lactam combinations</strong>: Ceftazidime avibactam, Ceftaroline avibactam, Ceftolozane tazobactam
<strong>Cephalosporins</strong>: Cefepime, Ceftazidime, Ceftriaxone, Cefoxitin, Cefixime
<strong>Aminoglycosides</strong>: Amikacin, Gentamicin, Tobramycin, Streptomycin
<strong>Fluoroquinolones</strong>: Ciprofloxacin, Levofloxacin, Gatifloxacin, Moxifloxacin
<strong>Others</strong>: Colistin, Vancomycin, Linezolid, Tigecycline, etc.</p>
<h2>Training Process</h2>
<h3>1. Data Loading and Cleaning</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Load ATLAS data</span>
<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;2.xlsx&quot;</span><span class="p">)</span>

<span class="c1"># Clean MIC values</span>
<span class="k">def</span><span class="w"> </span><span class="nf">clean_mic_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
        <span class="n">cleaned_value</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^\d.]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">cleaned_value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>

<h3>2. Resistance Threshold Definition</h3>
<div class="codehilite"><pre><span></span><code><span class="n">thresholds</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Meropenem&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;Imipenem&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;Doripenem&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;Ertapenem&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Tebipenem&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s1">&#39;Ceftazidime avibactam&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;Ceftaroline avibactam&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Ceftolozane tazobactam&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s1">&#39;Meropenem vaborbactam&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;Aztreonam avibactam&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;Ceftibuten avibactam&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s1">&#39;Cefepime&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;Ceftazidime&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;Ceftriaxone&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span> <span class="s1">&#39;Cefoxitin&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
    <span class="s1">&#39;Cefixime&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Ceftaroline&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Ceftibuten&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Cefpodoxime&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;Cefoperazone sulbactam&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span> <span class="s1">&#39;Piperacillin tazobactam&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
    <span class="s1">&#39;Ampicillin sulbactam&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;Amoxycillin clavulanate&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
    <span class="s1">&#39;Ampicillin&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;Penicillin&#39;</span><span class="p">:</span> <span class="mf">0.12</span><span class="p">,</span> <span class="s1">&#39;Oxacillin&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;Amikacin&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span> <span class="s1">&#39;Gentamicin&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;Tobramycin&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;Streptomycin&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
    <span class="s1">&#39;Ciprofloxacin&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Levofloxacin&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;Gatifloxacin&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;Moxifloxacin&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s1">&#39;Colistin&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Polymyxin B&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s1">&#39;Tigecycline&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;Minocycline&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;Tetracycline&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
    <span class="s1">&#39;Vancomycin&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;Teicoplanin&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;Daptomycin&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Linezolid&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s1">&#39;Clarithromycin&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;Erythromycin&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;Azithromycin&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;Clindamycin&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s1">&#39;Metronidazole&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;Trimethoprim sulfa&#39;</span><span class="p">:</span> <span class="mi">76</span><span class="p">,</span> <span class="s1">&#39;Sulfamethoxazole&#39;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
    <span class="s1">&#39;Quinupristin dalfopristin&#39;</span><span class="p">:</span> <span class="mi">4</span>
<span class="p">}</span>
</code></pre></div>

<h3>3. Antibiotic Scoring</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_antibiotic_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">antibiotic_columns</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate efficacy scores for each antibiotic.&quot;&quot;&quot;</span>
    <span class="n">scores_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Species&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">antibiotic_columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">resistant_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_resistant&quot;</span>
            <span class="k">if</span> <span class="n">resistant_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="c1"># Score based on proportion of susceptible strains</span>
                <span class="n">scores_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">resistant_col</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">scores_df</span>
</code></pre></div>

<h3>4. Optimal Antibiotic Order Determination</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">determine_antibiotic_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scores_df</span><span class="p">,</span> <span class="n">antibiotic_columns</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine optimal antibiotic order based on global efficacy.&quot;&quot;&quot;</span>
    <span class="n">antibiotic_efficacy</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">antibiotic_columns</span><span class="p">:</span>
        <span class="n">score_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_score&quot;</span>
        <span class="k">if</span> <span class="n">score_col</span> <span class="ow">in</span> <span class="n">scores_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">efficacy</span> <span class="o">=</span> <span class="n">scores_df</span><span class="p">[</span><span class="n">score_col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">antibiotic_efficacy</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">efficacy</span>

    <span class="c1"># Sort by decreasing efficacy</span>
    <span class="n">sorted_antibiotics</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">antibiotic_efficacy</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Add cefiderocol at the end (last resort)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">antibiotic_order</span> <span class="o">=</span> <span class="p">[</span><span class="n">ab</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ab</span> <span class="ow">in</span> <span class="n">sorted_antibiotics</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Cefiderocol&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">antibiotic_order</span>
</code></pre></div>

<h3>5. Decision Feature Creation</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_decision_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scores_df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create features for decision tree.&quot;&quot;&quot;</span>
    <span class="c1"># Encode categorical variables</span>
    <span class="n">le_species</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
    <span class="n">le_country</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>

    <span class="n">scores_df</span><span class="p">[</span><span class="s1">&#39;species_encoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_species</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">scores_df</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Unknown&#39;</span><span class="p">))</span>
    <span class="n">scores_df</span><span class="p">[</span><span class="s1">&#39;country_encoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_country</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">scores_df</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Unknown&#39;</span><span class="p">))</span>

    <span class="c1"># Create resistance features by antibiotic class</span>
    <span class="n">beta_lactam_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">scores_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">col</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;penem&#39;</span><span class="p">,</span> <span class="s1">&#39;cef&#39;</span><span class="p">,</span> <span class="s1">&#39;penicillin&#39;</span><span class="p">,</span> <span class="s1">&#39;tazobactam&#39;</span><span class="p">,</span> <span class="s1">&#39;avibactam&#39;</span><span class="p">])]</span>
    <span class="n">aminoglycoside_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">scores_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">col</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;micin&#39;</span><span class="p">,</span> <span class="s1">&#39;gentamicin&#39;</span><span class="p">,</span> <span class="s1">&#39;tobramycin&#39;</span><span class="p">,</span> <span class="s1">&#39;streptomycin&#39;</span><span class="p">])]</span>
    <span class="n">quinolone_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">scores_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">col</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;floxacin&#39;</span><span class="p">])]</span>
    <span class="n">other_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">scores_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">col</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;colistin&#39;</span><span class="p">,</span> <span class="s1">&#39;vancomycin&#39;</span><span class="p">,</span> <span class="s1">&#39;linezolid&#39;</span><span class="p">,</span> <span class="s1">&#39;tigecycline&#39;</span><span class="p">])]</span>

    <span class="c1"># Calculate mean resistance scores by class</span>
    <span class="n">scores_df</span><span class="p">[</span><span class="s1">&#39;beta_lactam_resistance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores_df</span><span class="p">[</span><span class="n">beta_lactam_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">scores_df</span><span class="p">[</span><span class="s1">&#39;aminoglycoside_resistance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores_df</span><span class="p">[</span><span class="n">aminoglycoside_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">scores_df</span><span class="p">[</span><span class="s1">&#39;quinolone_resistance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores_df</span><span class="p">[</span><span class="n">quinolone_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">scores_df</span><span class="p">[</span><span class="s1">&#39;other_resistance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores_df</span><span class="p">[</span><span class="n">other_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scores_df</span>
</code></pre></div>

<h3>6. Model Training</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">train_decision_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features_df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Train decision tree to recommend first antibiotic.&quot;&quot;&quot;</span>
    <span class="c1"># Select features</span>
    <span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;species_encoded&#39;</span><span class="p">,</span> <span class="s1">&#39;country_encoded&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;beta_lactam_resistance&#39;</span><span class="p">,</span> <span class="s1">&#39;aminoglycoside_resistance&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;quinolone_resistance&#39;</span><span class="p">,</span> <span class="s1">&#39;other_resistance&#39;</span><span class="p">]</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">features_df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Create target: first antibiotic recommendation</span>
    <span class="n">first_choice</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">features_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">best_antibiotic</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">best_score</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">ab</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">antibiotic_order</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>  <span class="c1"># Exclude cefiderocol</span>
            <span class="n">score_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ab</span><span class="si">}</span><span class="s2">_score&quot;</span>
            <span class="k">if</span> <span class="n">score_col</span> <span class="ow">in</span> <span class="n">features_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">features_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">score_col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">best_score</span><span class="p">:</span>
                    <span class="n">best_score</span> <span class="o">=</span> <span class="n">features_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">score_col</span><span class="p">]</span>
                    <span class="n">best_antibiotic</span> <span class="o">=</span> <span class="n">ab</span>
        <span class="n">first_choice</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_antibiotic</span> <span class="k">if</span> <span class="n">best_antibiotic</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">antibiotic_order</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Encode target</span>
    <span class="n">le_target</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">le_target</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">first_choice</span><span class="p">)</span>

    <span class="c1"># Train/test split</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># Train decision tree</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">decision_tree</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">decision_tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span>
</code></pre></div>

<h2>Performance Metrics</h2>
<h3>Model Performance</h3>
<ul>
<li><strong>Accuracy</strong>: 100% (reported)</li>
<li><strong>Target</strong>: First antibiotic recommendation</li>
<li><strong>Output</strong>: Complete antibiotic sequence</li>
</ul>
<h3>Antibiotic Order (Top 20)</h3>
<ol>
<li>Cefoperazone sulbactam</li>
<li>Gatifloxacin</li>
<li>Tetracycline</li>
<li>Metronidazole</li>
<li>Cefoxitin</li>
<li>Linezolid</li>
<li>Daptomycin</li>
<li>Ertapenem</li>
<li>Quinupristin dalfopristin</li>
<li>Teicoplanin</li>
<li>Tigecycline</li>
<li>Meropenem vaborbactam</li>
<li>Sulbactam</li>
<li>Ceftibuten</li>
<li>Vancomycin</li>
<li>Clarithromycin</li>
<li>Azithromycin</li>
<li>Ceftaroline avibactam</li>
<li>Doripenem</li>
<li>Ceftazidime avibactam
...</li>
<li>Cefiderocol (last resort)</li>
</ol>
<h2>Clinical Application</h2>
<h3>Recommendation Process</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">recommend_antibiotics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">species</span><span class="p">,</span> <span class="n">country</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">resistance_profile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recommend antibiotic sequence for a given case.&quot;&quot;&quot;</span>
    <span class="c1"># Prepare features</span>
    <span class="n">species_encoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoders</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="n">species</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">country_encoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoders</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="n">country</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Create feature vector</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>
        <span class="n">species_encoded</span><span class="p">,</span> <span class="n">country_encoded</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span>
        <span class="n">resistance_profile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;beta_lactam&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span> <span class="k">if</span> <span class="n">resistance_profile</span> <span class="k">else</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">resistance_profile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;aminoglycoside&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span> <span class="k">if</span> <span class="n">resistance_profile</span> <span class="k">else</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">resistance_profile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;quinolone&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span> <span class="k">if</span> <span class="n">resistance_profile</span> <span class="k">else</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">resistance_profile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span> <span class="k">if</span> <span class="n">resistance_profile</span> <span class="k">else</span> <span class="mf">0.5</span>
    <span class="p">]])</span>

    <span class="c1"># Predict first antibiotic</span>
    <span class="n">first_choice_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decision_tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">first_choice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoders</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">([</span><span class="n">first_choice_idx</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Build complete sequence</span>
    <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">used_antibiotics</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="c1"># Add first choice</span>
    <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first_choice</span><span class="p">)</span>
    <span class="n">used_antibiotics</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">first_choice</span><span class="p">)</span>

    <span class="c1"># Add alternatives in efficacy order</span>
    <span class="k">for</span> <span class="n">ab</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">antibiotic_order</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ab</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">used_antibiotics</span><span class="p">:</span>
            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>
            <span class="n">used_antibiotics</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">recommendations</span>
</code></pre></div>

<h3>Example Usage</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Example recommendation</span>
<span class="n">recommendations</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">recommend_antibiotics</span><span class="p">(</span>
    <span class="n">species</span><span class="o">=</span><span class="s2">&quot;Escherichia coli&quot;</span><span class="p">,</span>
    <span class="n">country</span><span class="o">=</span><span class="s2">&quot;France&quot;</span><span class="p">,</span> 
    <span class="n">year</span><span class="o">=</span><span class="mi">2023</span><span class="p">,</span>
    <span class="n">resistance_profile</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;beta_lactam&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;quinolone&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Output: Complete antibiotic sequence with cefiderocol as last resort</span>
</code></pre></div>

<h2>Clinical Decision Framework</h2>
<h3>1. First-Line Treatment</h3>
<ul>
<li>Model predicts most effective antibiotic based on species, region, and resistance patterns</li>
<li>Considers global efficacy data from ATLAS database</li>
</ul>
<h3>2. Sequential Alternatives</h3>
<ul>
<li>Provides complete sequence of alternatives</li>
<li>Each subsequent option is less effective but still viable</li>
<li>Maintains therapeutic options for treatment failure</li>
</ul>
<h3>3. Last Resort (Cefiderocol)</h3>
<ul>
<li>Always positioned as final option</li>
<li>Preserves this critical antibiotic</li>
<li>Used only when other options fail</li>
</ul>
<h2>Data Sources</h2>
<h3>Primary Data</h3>
<ul>
<li><strong>ATLAS Database</strong> (2.xlsx): Global antimicrobial susceptibility data</li>
<li><strong>Coverage</strong>: Multiple countries, species, and time periods</li>
<li><strong>Antibiotics</strong>: 40+ antibiotics with MIC values</li>
</ul>
<h3>Data Quality</h3>
<ul>
<li>MIC value cleaning and standardization</li>
<li>Resistance threshold application</li>
<li>Missing value handling</li>
<li>Categorical encoding</li>
</ul>
<h2>Technical Implementation</h2>
<h3>Code Structure</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AntibioticDecisionTree</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_atlas_data</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">clean_mic_values</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_antibiotic_data</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_resistance_threshold</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_antibiotic_scores</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">determine_antibiotic_order</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_decision_features</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">train_decision_tree</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">recommend_antibiotics</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">visualize_tree</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_report</span><span class="p">()</span>
</code></pre></div>

<h3>Dependencies</h3>
<ul>
<li><strong>Scikit-learn</strong>: DecisionTreeClassifier, LabelEncoder</li>
<li><strong>Pandas/NumPy</strong>: Data manipulation</li>
<li><strong>Matplotlib</strong>: Visualization</li>
<li><strong>Seaborn</strong>: Plotting</li>
</ul>
<h3>Output Files</h3>
<ul>
<li><strong>Reports</strong>: <code>outputs/antibiotic_decision_tree_report.md</code></li>
<li><strong>Visualizations</strong>: <code>outputs/plots/antibiotic_decision_tree.png</code></li>
<li><strong>PDF Reports</strong>: <code>outputs/antibiotic_recommendation_report_english.pdf</code></li>
</ul>
<h2>Clinical Validation</h2>
<h3>Strengths</h3>
<ol>
<li><strong>Evidence-based</strong>: Uses global ATLAS data</li>
<li><strong>Sequential approach</strong>: Provides complete treatment sequence</li>
<li><strong>Antimicrobial stewardship</strong>: Preserves cefiderocol</li>
<li><strong>Regional consideration</strong>: Accounts for geographic resistance patterns</li>
<li><strong>Species-specific</strong>: Tailored to bacterial species</li>
</ol>
<h3>Limitations</h3>
<ol>
<li><strong>Retrospective data</strong>: Based on historical susceptibility patterns</li>
<li><strong>Simplified resistance</strong>: Uses binary resistance indicators</li>
<li><strong>Clinical factors</strong>: Doesn't include patient-specific factors</li>
<li><strong>Validation needed</strong>: Requires clinical validation before use</li>
</ol>
<h2>Future Enhancements</h2>
<h3>1. Clinical Integration</h3>
<ul>
<li>Include patient factors (age, comorbidities, allergies)</li>
<li>Add pharmacokinetic considerations</li>
<li>Integrate with local resistance patterns</li>
</ul>
<h3>2. Model Improvements</h3>
<ul>
<li>Include genomic resistance markers</li>
<li>Add temporal resistance trends</li>
<li>Develop species-specific models</li>
</ul>
<h3>3. Clinical Validation</h3>
<ul>
<li>Prospective clinical studies</li>
<li>Real-world implementation</li>
<li>Outcome assessment</li>
</ul>
<h2>Summary</h2>
<p>The <strong>Antibiotic Recommendation System</strong> provides a comprehensive framework for sequential antibiotic treatment recommendations. It successfully addresses the clinical requirement to provide first-line treatment options while preserving critical antibiotics like cefiderocol for last resort use.</p>
<p><strong>Key Clinical Value</strong>: 
- Evidence-based antibiotic sequencing
- Antimicrobial stewardship compliance
- Regional resistance pattern consideration
- Complete treatment pathway provision</p>
<p>This model serves as the foundation for clinical decision support in antibiotic therapy, providing a systematic approach to treatment selection that balances efficacy with antibiotic preservation.</p>
        
        <div class="footer">
            <p>This document provides comprehensive details about the Antibiotic Recommendation System, the core prediction model in the Vivli system.</p>
            <p>For technical support or questions, please refer to the source code and documentation.</p>
        </div>
    </div>
    
    <script>
        // Add smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // Add syntax highlighting for code blocks
        document.querySelectorAll('pre code').forEach(block => {
            block.style.display = 'block';
        });
        
        // Add hover effects for feature boxes
        document.querySelectorAll('.feature-box').forEach(box => {
            box.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-2px)';
                this.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
            });
            
            box.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = '0 2px 4px rgba(0,0,0,0.1)';
            });
        });
    </script>
</body>
</html>
